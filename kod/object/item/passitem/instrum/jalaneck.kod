% Meridian 59, Copyright 1994-2012 Andrew Kirmse and Chris Kirmse.
% All rights reserved.
%
% This software is distributed under a license that is described in
% the LICENSE file that accompanies it.
%
% Meridian is a registered trademark.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
JalaNecklace is Instrument

% This "instrument" is special. It takes up the neck slot instead of the hands
% slot. It also allows the user to maintain concentration in combat (attacking
% and getting damaged).  The code for this is in spell/jala.kod.

constants:

   include blakston.khd

resources:

   include jalaneck.lkod

   JalaNecklace_name_rsc = "necklace of Jala"
   JalaNecklace_icon_rsc = jalaneck.bgf
   JalaNecklace_desc_rsc = \
      "This necklace looks like it would fit tightly around your neck.  The "
      "golden musical note hints that this necklace may be of some value to "
      "those that call themselves Bards."
      "\n\nTo imbue the resonating notes of a song into this necklace, "
      "a Bard must wear it and begin to sing. Depending on the the song, "
      "the necklace will reserve a set portion of the Bard's mana to emanate music "
      "on an ongoing basis."

   JalaNecklace_used_rsc = \
      "The necklace of Jala vibrates against your throat, ready to imitate "
      "the patterns of your voice."
   JalaNecklace_unused_rsc = "Your voice loses its potence."

classvars:

   vrName = JalaNecklace_name_rsc
   vrDesc = JalaNecklace_desc_rsc

   vrIcon = JalaNecklace_icon_rsc
   vrInstrument_overlay = $
   viInstrument_strength = 5

   viUse_type = ITEM_USE_THROAT
   viItem_type = ITEMTYPE_THROAT
   viUse_amount = 1  % Only use one neck.  Heh.

   viGround_group = 2

   viValue_average = 2000
   viWeight = 75
   viBulk = 150

properties:

   piItemLevel = 200

messages:

   NewUsed(what=$)
   {
      if what <> $
      {
         Send(what,@MsgSendUser,#message_rsc=JalaNecklace_used_rsc);
      }

      propagate;
   }

   NewUnused(what=$)
   {
      if what <> $
      {
         Send(what,@MsgSendUser,#message_rsc=JalaNecklace_unused_rsc);
         Send(what,@UnReserveAllSongs);
      }

      propagate;
   }

   GetPrefixes()
   {
      return [[&ManaMod,100],
              [&VigorMod,100],
              [&FireEmpowermentMod,100],
              [&AcidEmpowermentMod,100],
              [&ColdEmpowermentMod,100],
              [&ShockEmpowermentMod,100],
              [&MagicEmpowermentMod,1],
              [&ThrustEmpowermentMod,100],
              [&SlashEmpowermentMod,100],
              [&BludgeonEmpowermentMod,100],
              [&PierceEmpowermentMod,100],
              [&WeaponEmpowermentMod,1]];
   }
   
   GetSuffixes()
   {
      return [[&FireResistanceMod,100],
              [&ColdResistanceMod,100],
              [&ShockResistanceMod,100],
              [&AcidResistanceMod,100],
              [&PierceResistanceMod,100],
              [&SlashResistanceMod,100],
              [&BludgeonResistanceMod,100],
              [&ThrustResistanceMod,100],
              [&HolyResistanceMod,20],
              [&UnholyResistanceMod,20],
              [&WeaponAgilityMod,50],
              [&WeaponMightMod,50],
              [&WeaponAimMod,50]];
   }

end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
